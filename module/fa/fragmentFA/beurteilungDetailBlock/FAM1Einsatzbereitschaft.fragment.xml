<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:rt="de.bundeswehr.zaxxx.framework.v010.global.control.ratingAndTrending"
    core:require="{ABAPBoolean:'de/bundeswehr/zaxxx/framework/v010/global/model/ABAPBoolean'}">

    <CheckBox
        text="Nicht beurteilt"
        valueState="Information"
        editable="{= ${viewModel>/bEditing} }"
        selected="{
                   path : 'NichtBeurEinsatzbereit',
                   type : 'ABAPBoolean' 
                }"
        visible="{= ${NichtBeurEinsatzbereit} === 'X' || ${viewModel>/bEditing} }" />


    <FlexBox
        alignItems="Start"
        justifyContent="SpaceBetween"
        class="sapUiSmallMarginBottom">

        <VBox width="100%">
            <Label
                text="Beurteilung und Trend (2 Jahre):"
                required="{= ${viewModel>/bEditing} }"
                class="sapUiSmallMarginEnd"
                visible="{= ${NichtBeurEinsatzbereit} !== 'X' }" />

            <HBox
                visible="{= ${NichtBeurEinsatzbereit} !== 'X' }"
                class="sapUiSmallMarginBegin">
                <rt:RatingAndTrending
                    id="RatingAndTrendingEinsatzbereitschaft"
                    visibleRatingLeft="false"
                    visibleRatingRight="false"
                    visibleTrendingLeft="false"
                    visibleTrendingRight="false"
                    enableRatingTrendingCheck="true"
                    ratingButtonWidth="200px"
                    tooltipRatingRot="sehr kritisch"
                    tooltipRatingGelb="kritisch"
                    tooltipRatingKeine="keine Angabe"
                    tooltipRatingGruen="unkritisch"
                    valueRating1="{BeurEinsatzbereit}"
                    valueTrending1="{TrendEinsatzbereit}"
                    ratingEditable="{= ${viewModel>/bEditing} }"
                    trendingEditable="{= ${viewModel>/bEditing} }" />
            </HBox>

            <Label
                text="Anmerkung Einsatzbereitschaft:"
                required="{= ${viewModel>/bEditing} }"
                class="sapUiTinyMarginTop"
                visible="{= ${NichtBeurEinsatzbereit} !== 'X' }" />

            <TextArea
                value="{ path: 'AnmerkungEinsatzbereit', type: 'sap.ui.model.type.String', constraints: {minLength: 1, maxLength: 500} }"
                valueStateText="Anmerkung Einsatzbereitschaft kann nur bis 500 Zeichen beinhalten und darf nicht leer sein."
                showExceededText="true"
                editable="{= ${viewModel>/bEditing} }"
                maxLength="500"
                width="100%"
                growing="true"
                growingMaxLines="7"
                valueLiveUpdate="false"
                liveChange="handleLiveChange"
                visible="{= ${NichtBeurEinsatzbereit} !== 'X' &amp;&amp; ${viewModel>/bEditing} }"
                class="sapUiSmallMarginBegin" />

            <Text
                text="{= ${AnmerkungEinsatzbereit} === '' ? 'Keine Anmerkungen vorhanden' : ${AnmerkungEinsatzbereit}}"
                visible="{= ${NichtBeurEinsatzbereit} !== 'X' &amp;&amp; !${viewModel>/bEditing} }"
                width="100%"
                class="sapUiSmallMarginBegin" />
        </VBox>

        <Button
            press=".onDependentDialogOpen"
            icon="sap-icon://hint"
            tooltip="Begriffsdefinitionen"
            visible="{= ${NichtBeurEinsatzbereit} !== 'X' }">
            <dependents>
                <Dialog
                    contentHeight="250px"
                    contentWidth="600px"
                    xmlns="sap.m"
                    icon="sap-icon://hint"
                    title="Einsatzbereitschaft - Begriffsdefinitionen">
                    <VBox class="sapUiSmallMargin">
                        <Text text="{i18n>BegriffsdefinitionEinsatzbereitschaft}" />
                    </VBox>
                    <buttons>
                        <Button
                            text="Abbrechen"
                            press=".onDependentDialogClose" />
                    </buttons>
                </Dialog>
            </dependents>
        </Button>

    </FlexBox>

</core:FragmentDefinition>            